name: kiss-lint
author: jedahan
description: run kiss-lint on your kiss repositories
branding:
  icon: 'moon'  
  color: 'blue'
inputs:
  kiss_path:
    description: ':-delimited list of paths to check, relative to the repository root'
    required: false
    default: '.'
runs:
  using: 'composite'
  steps:
    - run: |
        echo ::group::linting...
        echo ::INPUT_KISS_PATH is $INPUT_KISS_PATH
        export KISS_PATH=$(echo $INPUT_KISS_PATH | /usr/bin/sed -e "s|^|${GITHUB_WORKSPACE}/|" -e "s|:|:${GITHUB_WORKSPACE}/|")
        echo ::kiss_path is $KISS_PATH
        output=$(/usr/bin/curl --silent --location \
          https://raw.githubusercontent.com/jedahan/kiss-repo/1370e9d22452e0646fcfa777c54747848038a0c5/kiss-lint/files/kiss-lint \
          | /usr/bin/bash 2>&1 | sed -e 's|^.*error: |error |' -e 's|^.*warning: |warning|')
        echo $output && test -z "$output"
        echo ::endgroup::
      shell: bash
      env:
        INPUT_KISS_PATH: ${{ inputs.kiss_path }}
